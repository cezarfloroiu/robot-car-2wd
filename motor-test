/*
  Blink
*/

// ledPin refers to ESP32 GPIO 23
const int ledPin = 2;
const int in1 = 25;
const int in2 = 33;
const int enA = 32;

// Setting PWM properties
const int freq = 30000;
const int pwmChannel = 0;
const int resolution = 8;


// the setup function runs once when you press reset or power the board
void setup() {
  Serial.begin(115200);
  // initialize digital pin ledPin as an output.
  pinMode(ledPin, OUTPUT);
  
  pinMode(in1, OUTPUT);
  pinMode(in2, OUTPUT);
  pinMode(enA, OUTPUT);

 // configure PWM functionalitites
  ledcSetup(pwmChannel, freq, resolution);
  ledcAttachPin(enA, pwmChannel);

  digitalWrite(in1, LOW);
  digitalWrite(in2, LOW);


}

// the loop function runs over and over again forever
void loop() {
  Serial.printf("Blink on-board led\n");

  digitalWrite(ledPin, HIGH);   // turn the LED on (HIGH is the voltage level)
  delay(100);                  // wait for a second
  digitalWrite(ledPin, LOW);    // turn the LED off by making the voltage LOW
  delay(100);                  // wait for a second


  Serial.printf("starting motor at max speed\n");
  digitalWrite(in1, HIGH);
  digitalWrite(in2, LOW);

  delay(2000);

  // Accelerate from zero to maximum speed
  Serial.printf("accelerating motor\n");

  for (int i = 100; i < 256; i++) {
    ledcWrite(pwmChannel, i);
    //analogWrite(enA, i);
    delay(50);
  }  

  Serial.printf("stopping motor\n\n");
  digitalWrite(in1, LOW);
  digitalWrite(in2, LOW);

  delay(2000);
  
  //delay(5000);
  //digitalWrite(in1, LOW);
  //digitalWrite(in2, LOW);
  
}
